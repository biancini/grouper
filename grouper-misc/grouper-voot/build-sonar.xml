<project name="SonarAntProject" default="sonar">
	<path id="sonar.classpath">
		<fileset dir="${buildtools.dir}" includes="**/*.jar" />
 	</path>

	<taskdef uri="antlib:org.sonar.ant" resource="org/sonar/ant/antlib.xml">
    		<classpath refid="sonar.classpath" />
  	</taskdef>

	<property name="build.version" value="2.2.1"/>
  	<property name="mysonar.organizationName" value="it.garr"/>
   	<property name="sonar.java.binaries" value="${dist.dir}/bin" />
   	<property name="sonar.binaries" value="${dist.dir}/bin" />
   	<property name="sonar.projectName" value="Grouper" />
	<property name="sonar.surefire.reportsPath" value="${build.dir.test}"/>
	<property name="sonar.junit.reportsPath" value="${build.dir.test}"/>
	<property name="sonar.core.codeCoveragePlugin" value="jacoco"/>
	<property name="sonar.jacoco.reportPath" value="${build.dir.test}/jacoco.exec" />

  	<target name="sonar" depends="clean, compile, test.compile, test">
		<property name="sonar.jdbc.url" value="jdbc:mysql://sonarqube.mib.garr.it:3306/sonar?useUnicode=true&amp;characterEncoding=utf8" />
		<property name="sonar.jdbc.driverClassName" value="com.mysql.jdbc.Driver" />
		<property name="sonar.jdbc.username" value="sonar" />
		<property name="sonar.jdbc.password" value="sonar" />
		<property name="sonar.host.url" value="http://sonarqube.mib.garr.it" />

		<sonar:sonar key="${mysonar.organizationName}:${sonar.projectName}" version="${build.version}" xmlns:sonar="antlib:org.sonar.ant">
			<sources>
				<path location="${src.dir}"/>
			</sources>
			<tests>
	    			<path location="${src.dir.test}"/>
		    	</tests>
		</sonar:sonar>
 	</target>
</project>
